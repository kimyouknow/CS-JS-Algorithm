# 웹 브라우저에 URL을 입력하면 어떤 일이 생기나요?

웹 브라우저에 URL을 입력하면 어떤 과정을 거쳐 사용자에게 화면이 표시되는지 알아보겠습니다. 이 질문은 인터뷰 단골 문제로 알려져있는데요 왜 중요할까요?

해당 질문에 대한 답변을 말하는 과정에서 웹 브라우저, pc 운영체제, 인터넷 서비스 제공업체, 웹 사이트를 호스팅하는 서버, 해당 서버에서 실행되는 서비스에 대한 지식 등이 필요하기 때문입니다. 이를 통해, 문제가 발생했을 때, 문제가 발생할 수 있는 위치와 성능 문제가 발생할 수 있는 위치를 파악하고 사용자에게 안전한 경험을 제공하고 있는지 확인하 수 있습니다.

```md
웹 브라우저에 URL을 입력하고 Enter 키를 누릅니다.
웹 브라우저가 도메인의 IP 주소를 조회합니다. (먼저 캐시를 찾고, 그다음 DNS를 검색합니다.)
웹 브라우저가 찾은 IP 주소를 기반으로 서버와의 TCP 연결을 시작합니다.
웹 브라우저가 HTTP 요청을 서버로 전송합니다. (필요한 경우, HTTPS 보안 통신이 진행됩니다.)
웹 서버가 요청을 처리하고 응답을 다시 웹 브라우저로 전송합니다.
웹 브라우저가 전송 받은 콘텐츠를 렌더링합니다.
```

## 웹 브라우저에 URL을 입력하고 Enter 키를 누릅니다.

입력받은 URL 파싱

- URL에는 어떤 프로토콜로 해당 URL에 요청할지, 어떤 포트로 요청할지에 대한 정보가 들어있다.
- 예시: https://kimyouknow.github.io
  - `https://` - 통신규약(Protocol): 데이터를 교환할 때 따르는 표준화된 통신 규칙이다. 송신자와 수신자 간에 데이터를 전달하고 전달받는 절차나 데이터 양식.
- `kimyouknow.github.io` - 도메인(Domain): 기억하기 쉬운 주소이며 특정 서버의 IP 주소를 가르킨다.
- 기본 포트는 생략(https:443)

## 웹 브라우저가 도메인의 IP 주소를 조회합니다. (먼저 캐시를 찾고, 그다음 DNS를 검색합니다.)

브라우저에서 올바른 URL을 입력한 후 Enter 키를 누르면 브라우저는 인터넷에서 연결할 서버를 파악해야 한다. 이 때, 입력한 도메인을 사용하여 웹 사이트를 호스팅하는 서버의 IP 주소를 조회해야 한다. DNS 조회를 사용하여 이 작업이 수행되는데, DNS는 복잡하고 매우 빨라야 하기 때문에 DNS 데이터는 웹 브라우저 사이의 서로 다른 계층과 인터넷의 다양한 위치에 임시로 저장된다.

DNS는 복잡하고 매우 빨라야 하기 때문에 DNS 데이터는 웹 브라우저 사이의 서로 다른 계층과 인터넷의 다양한 위치에 임시로 저장된다. 이를 캐시(Cache)라고 부르는데, 웹 브라우저는 고유한 캐시, 운영 체제 캐시, 라우터의 로컬 네트워크 캐시, 회사 네트워크 또는 인터넷 서비스 제공업체(ISP)의 DNS 서버 캐시를 확인한다.

- 캐싱

요청된 값의 결과값을 저장하고, 그 값을 일정 시간 내에 다시 요청하면 다시 제공하는 기술

- 캐싱 과정
  - DNS 쿼리를 캐시에서 먼저 실행한다. DNS 기록을 찾기 위해 브라우저는 4개의 캐시를 탐색한다.
  - 브라우저 캐시: 컴퓨터는 주소창에 입력된 주소를 브라우저 캐시에서 가장 먼저 확인한다.
  - OS(운영체제) 캐시: 브라우저 캐시에서 해당 IP 를 발견하지 못하면, systemcall을 통해서 OS가 저장하고 있는 DNS 기록들의 캐시에 접근한다.
  - Router(라우터) 캐시: 컴퓨터에서 DNS 기록을 찾지 못하면 브라우저는 DNS 기록을 캐싱하고 있는 router와 통신을 해서 찾으려고 한다.
  - ISP(인터넷 서비스 제공 업체) 캐시: ISP

ISP 캐시에도 없다면 DNS query를 날려 IP 주소를 얻어온다.

## 웹 브라우저가 찾은 IP 주소를 기반으로 서버와의 TCP 연결을 시작합니다.

브라우저를 통해 HTTP 통신을 한다. HTTP 통신은 TCP를 기반으로 통신하기 때문에 TCP 연결을 한다.

하지만, 웹 서버에 직접 도달하는 방법은 위치에 따라 효율적이지 않을 수 있기 때문에 요즘에는 많은 웹 사이트들이 직접 서버에 연결하기 보다는 콘텐츠 전송 네트워크(CDN)를 사용하여 정적 및 동적 콘텐츠를 웹 브라우저 가까이에 위치 시킨다.

## 웹 브라우저가 HTTP 요청을 서버로 전송합니다. (필요한 경우, HTTPS 보안 통신이 진행됩니다.)

TCP 연결이 성공하여 웹 브라우저가 서버에 연결되면, HTTP(s) 프로토콜에 대한 통신 규칙을 따른다.

웹 브라우저가 페이지의 콘텐츠를 요청하기 위해 서버에 HTTP 요청을 전송한다.웹 서버가 클라이언트로부터 요청을 받으면 서버는 요청을 처리하고 응답을 다시 전송한다.

## 웹 서버가 요청을 처리하고 응답을 다시 웹 브라우저로 전송합니다.

웹 서버는 클라이언트에게 응답을 전송한다.

## 웹 브라우저가 전송 받은 콘텐츠를 렌더링합니다.

웹 브라우저가 서버로부터 응답을 받으면 응답 헤더를 검사하여 리소스를 렌더링하는 방법에 대한 정보를 확인한다. 예를 들어, `Content-Type: text/html;`라는 Content-Type 헤더는 브라우저에 응답 본문에서 HTML 리소스를 수신했다고 알려준다.

## 참고자료

- https://aws.amazon.com/ko/blogs/korea/what-happens-when-you-type-a-url-into-your-browser/
- https://babycoder05.tistory.com/entry/wwwgooglecom-을-주소창에-치면-일어나는-일-What-happens-when-type-wwwgooglecom
- https://youtu.be/GAyZ_QgYYYo
